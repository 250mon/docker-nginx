services:
  nginx:
    build: .
    container_name: dev-nginx
    ports:
      - "8080:80"
    networks:
      - my_shared_proxy_net
    environment:
      # IP addresses for backend services
      - AUTH_APP_IP=${AUTH_APP_IP}
      - AUTH_APP_PORT=${AUTH_APP_PORT}
      - INVENTORY_APP_IP=${INVENTORY_APP_IP}
      - INVENTORY_APP_PORT=${INVENTORY_APP_PORT}
      - PRESCRIPTION_APP_IP=${PRESCRIPTION_APP_IP}
      - PRESCRIPTION_APP_PORT=${PRESCRIPTION_APP_PORT}
      - EMAILSENDER_FRONTEND_IP=${EMAILSENDER_FRONTEND_IP}
      - EMAILSENDER_FRONTEND_PORT=${EMAILSENDER_FRONTEND_PORT}
      - EMAILSENDER_API_IP=${EMAILSENDER_API_IP}
      - EMAILSENDER_API_PORT=${EMAILSENDER_API_PORT}
    volumes:
      # Mount proxy params files
      - ./proxy_params:/etc/nginx/proxy_params:ro
      - ./proxy_params_ws:/etc/nginx/proxy_params_ws:ro
      # Optionally mount static site files
      # - ./html:/usr/share/nginx/html:ro
    restart: always

networks:
  my_shared_proxy_net:
    external: true
